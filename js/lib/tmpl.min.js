/* Riot WIP, @license MIT, (c) 2015 Muut Inc. + contributors */
(function(e,n){var t="g";function r(e,n){return new RegExp(e,n)}var i=function(e){var n,c;function u(e){n=e;c=e.split(" ").concat(e.replace(/(?=[$\.\?\+\*\[\(\)\|^\\])/g,"\\").split(" "));c[4]=i(c[1].length>1?/{.*}/:/{[^}]*}/);c[5]=i(/^\s*({)\s*(([$\w]+)(?:\s*,\s*([$\w]+))?\s+in\s+([^\s]+?\s*}))\s*$/);c[6]=i(/\\({|})/g);e="(\\\\?)(";c[7]=r(e+c[2]+")",t);c[8]=e+"?:([{\\[\\(])|("+c[3]+"))"}return function f(i){var f=riot?riot.settings.brackets||e:e;if(n!==f)u(f);if(i instanceof RegExp){return f===e?i:r(i.source.replace(/[{}]/g,function(e){return c[(e==="}")+2]}),i.global?t:"")}return c[i]}}("{ }");var c=function(){var n={"@#1@":function(){return"name"}},c="￱",u=/@(\d+)\uFFF1/g,f=/("[^"\\]*(?:\\.[^"\\]*)*"|'[^'\\]*(?:\\.[^'\\]*)*')|((?:^|[-\+\*%~^&\|!=><\?:{\(\[,;]|\/\s)\s*)(\/(?!\/)(?:\[[^\]]*\]|\\.|[^\/\[\\]+)*\/[igm]*)/g,o=r(f.source+"|/\\*[^*]*\\*+(?:[^/*][^*]*\\*+)*/",t);function l(e,t){return e&&(n[e]||(n[e]=a(e))).call(t,t)}function a(e){if(e.indexOf(i(0))<0){e=e.replace(/\r\n?|\n/g,"\n");return function(){return e}}return new Function("D","return "+s(e)+";")}function s(e){var n=[],t,r,i=g(e.replace(o,function(e,n,t,r){return n||t+r||" "}));for(r=1;r<i.length;r+=2){i[r]=i[r].replace(f,function(e,t,r,i){if(e.length>2){e=t||i?(r||"")+"@"+(n.push(i||e)-1)+c:" "}return e})}if(i.length>2||i[0]){var l,a=[];for(r=l=0;r<i.length;++r){t=i[r];if(t&&(t=r&1?p(t,1,n):'"'+t.replace(/\r?\n|\r/g,"\\n").replace(/"/g,'\\"')+'"'))a[l++]=t}t=l>1?"["+a.join(",")+'].join("")':l?'""+'+a[0]:'""'}else{t=p(i[1],0,n)}t=t.replace(u,function(e,t){return n[t|0].replace(/\n/g,"\\n").replace(/\r/g,"\\r")});return t}function g(e){var n=[],c,u,o,l,a=i(6),s=i(7),g=[s,r(i(8)+"|"+f.source,t)];c=l=0;while(u=s.exec(e)){o=u.index;if(l){if(u[2]){s.lastIndex=d(e,u[2],!!u[1]+o,1);continue}if(!u[3])continue}if(!u[1]){p(e.slice(c,o));c=s.lastIndex;s=g[l^=1];s.lastIndex=c}}if(c<e.length)p(e.slice(c));return n;function p(e){n.push(e&&e.replace(a,"$1"))}function d(e,n,i){var c=0,u,o=r((n==="("?"(\\(|\\))":n==="["?"(\\[|\\])":"({|})")+"|"+f.source,t);o.lastIndex=i;while(u=o.exec(e)){if(u[1]){if(u[1]===n)++c;else if(!--c)break}}return u?o.lastIndex:e.length}}function p(e,n,t){e=e.replace(/\s+/g," ").replace(/^ | ?([\(\[{},\?\.:]) ?| $/g,"$1");if(!e)return"";var r=[],i;if(!x(e,r)){return m(e,n)}i=r.map(function(e){if(e[0])e[1]=t[e[0]|0].slice(1,-1).replace(/\s+/g," ").trim();return"("+m(e[2],0)+')?"'+e[1]+'":""'});return i.length<2?i[0]:"["+i.join(",")+'].join(" ").trim()'}var d=r("^("+u.source+"|-?[_A-Za-z][-\\w]*"+"):");function x(e,n){var t=/,|([\[{\(])|$/g,r=RegExp,i,c,u,f=0;while(e&&(i=e.match(d))&&!i.index){e=r.rightContext;t.lastIndex=0;while((c=t.exec(e))&&(u=c[1])){var o=u==="("?/[\(\)]/g:u==="["?/[\[\]]/g:/[{}]/g,l=1,a;o.lastIndex=c.index+1;while(l&&(a=o.exec(e))){a[0]===u?++l:--l}t.lastIndex=l?e.length:o.lastIndex}n[f++]=[i[2],i[1],e.slice(0,c.index)];e=r.rightContext}return f}var h='"in D?D:'+(typeof e==="object"?"window":"global")+").",v="[$_A-Za-z][$\\w]*",w=r("(^ *|[^$\\w\\.])"+"(?!(?:typeof|in|instanceof|void|new|function)[^$\\w]|true(?:[^$\\w]|$))"+"("+v+")"),$=r("(?=[,{]"+v+":)(.)",t);function m(e,n){var t=~e.indexOf("{");if(t)e=e.replace($,"$1￳0");var r=e.match(w);if(r){var i=[],c,u=0,f=RegExp;do{i.push(f.leftContext+(r[1]||""));e=f.rightContext;c=r[2];if(~["undefined","false","null","NaN"].indexOf(c))i.push(n?'""':c);else{i.push(~["this","window","global"].indexOf(c)?c:'("'+c+h+c);u=u||n||/^[\[\(\.]/.test(e)}}while(r=e.match(w));e=(i.join("")+e).trim();if(u){e="(function(D,v){try{v="+e+"}catch(e){}return "+(n?'v||v===0?v:""':"v")+"}).call(D,D)"}}return t?e.replace(/\uFFF30/g,""):e}return l}();if(typeof exports==="object"){module.exports={tmpl:c,brackets:i}}else if(typeof define==="function"&&define.amd){define(function(){return{tmpl:c,brackets:breackets}})}else if(e){e.tmpl=c;e.brackets=i}})(typeof window!=="undefined"?window:void 0);